id,risk,severity,likelihood,impact,area,evidence,mitigation,owner,status
R-CRIT-01,AppliesWhen DSL mismatch breaks rule evaluation,Critical,High,Critical,Rules DSL,"src/lib/regulatory-truth/prompts/index.ts:121 src/lib/regulatory-truth/dsl/applies-when.ts:44","Align DSL format and enforce validation on write; migrate existing rules",TBD,Resolved
R-CRIT-02,Composer SOURCE_CONFLICT writes SourcePointer IDs into rule conflict fields,Critical,High,Critical,Conflicts,"src/lib/regulatory-truth/agents/composer.ts:90 prisma/schema.prisma:1896 src/lib/regulatory-truth/agents/arbiter.ts:94","Keep itemAId/B null for SOURCE_CONFLICT or add SourcePointer relations; update Arbiter/Admin",TBD,Open
R-CRIT-03,Manual trigger endpoints are placeholders,Critical,High,High,Operations,"src/app/api/admin/regulatory-truth/trigger/route.ts:35 src/app/api/admin/regulatory-truth/sources/[id]/check/route.ts:35","Wire triggers to actual pipeline execution and return real job IDs",TBD,Resolved
R-HIGH-04,Document updates at same URL not re-fetched,High,High,High,Discovery,"src/lib/regulatory-truth/agents/sentinel.ts:149","Re-scan known URLs on schedule; re-queue when hash changes",TBD,Resolved
R-HIGH-05,Monitoring script uses wrong runSentinel signature,High,High,Medium,Monitoring,"src/lib/regulatory-truth/scripts/monitor.ts:99 src/lib/regulatory-truth/agents/sentinel.ts:213","Fix signature mismatch or add source-level sentinel API",TBD,Resolved
R-HIGH-06,Audit log missing evidence and conflict creation,High,High,High,Audit,"src/lib/regulatory-truth/utils/audit-log.ts:5 src/lib/regulatory-truth/agents/sentinel.ts:352","Add audit log calls for evidence fetch, conflict creation, admin actions",TBD,Resolved
R-HIGH-07,Agent runner lacks timeout/abort,High,Medium,High,Agents,"src/lib/regulatory-truth/agents/runner.ts:114","Add request timeouts, aborts, and stale run cleanup",TBD,Resolved
R-HIGH-08,Release approvals sourced from LLM output,High,Medium,High,Releases,"src/lib/regulatory-truth/agents/releaser.ts:221 prisma/schema.prisma:1859","Populate approvedBy from actual human approvals only",TBD,Resolved
R-MED-09,Authority derivation ignores source hierarchy in composer,Medium,Medium,Medium,Authority,"src/lib/regulatory-truth/agents/composer.ts:137 src/lib/regulatory-truth/utils/authority.ts:25","Use deriveAuthorityLevelAsync or map hierarchy explicitly",TBD,Open
R-MED-10,Rate limiter ignores maxRequestsPerMinute/maxConcurrent,Medium,Medium,Medium,Discovery,"src/lib/regulatory-truth/utils/rate-limiter.ts:3","Implement per-minute counters and concurrency gates",TBD,Open
R-MED-11,Evaluate endpoint caps rules at 1000 (may skip at scale),Medium,Medium,Medium,API,"src/app/api/rules/evaluate/route.ts:49","Paginate or pre-filter rules to avoid skipping",TBD,Open
R-MED-12,AppliesWhen between allows missing bounds,Medium,Low,Medium,Rules DSL,"src/lib/regulatory-truth/dsl/applies-when.ts:71","Require at least one bound or reject invalid predicates",TBD,Open
R-MED-13,Evidence hasChanged/changeSummary not set,Medium,Medium,Medium,Audit,"prisma/schema.prisma:1732 src/lib/regulatory-truth/agents/sentinel.ts:352","Set change metadata when evidence is created",TBD,Resolved
R-MED-14,Search endpoint lacks enum validation,Medium,Low,Medium,API,"src/app/api/rules/search/route.ts:46","Validate query params and return 400 on invalid enums",TBD,Resolved
R-MED-16,Source-specific manual check endpoint is still a placeholder,Medium,Medium,Medium,Operations,"src/app/api/admin/regulatory-truth/sources/[id]/check/route.ts:35","Invoke Sentinel for the selected source or enqueue a job",TBD,Open
R-MED-17,Audit log missing reviewer conflict creation and admin conflict resolution,Medium,Medium,Medium,Audit,"src/lib/regulatory-truth/agents/reviewer.ts:142 src/app/api/admin/regulatory-truth/conflicts/[id]/resolve/route.ts:76","Log CONFLICT_CREATED/CONFLICT_RESOLVED with actor metadata",TBD,Open
R-LOW-15,AI provider mismatch vs audit request,Low,Medium,Low,Ops/Docs,"src/lib/regulatory-truth/agents/runner.ts:9 docs/audits/2025-12-22-regulatory-truth-layer-audit-request.md","Align docs with implementation or implement Anthropic client",TBD,Open
R-LOW-18,Invalid appliesWhen predicates are skipped silently,Low,Low,Low,API,"src/app/api/rules/evaluate/route.ts:95","Return warnings or invalid rule IDs in responses",TBD,Open
